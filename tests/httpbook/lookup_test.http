# HTTP Book - Lookups API Scenarios
# @name lookup_api_tests
# Run "Login" first to get a token; then run "Fetch lookup" (it uses the token from login response).
#
# Requests that use {{authBaseUrl}} (Login, Next.js lookup fetch/options) need the app running:
#   npm run dev   (or start the Next.js server on the port below)
# If you get RequestError/AggregateError, the server is likely not running or not on this host/port.
###
# @name lookup_api_config
@baseUrl = https://octa.cinnagen.com
# Auth lives on the Next.js app (octa does not serve /api). Must be running for authBaseUrl requests.
@authBaseUrl = http://localhost:3000
@lookupId = 01KJ06YM685FYANN2ZVV4CGSGH
@loginEmail = abidi.mahyar@gmail.com
@loginPassword = Mm@123456
# Tenant domain (required by auth backend; use full URL as in browser, e.g. https://scm.cinnagen.com)
@tenantDomain = https://aryogen.cinnagen.com
# Optional: set a device fingerprint if your auth backend requires it (e.g. copy from browser cookie x-fingerprint)
@fingerprint = 6b26a04c17f1fd66366976d347a9679de223e3e0530fca64995be6c70d62db2b
###
# Login – run this first to get and set the token for subsequent requests
# @name login
# @no-cookie-jar
POST {{authBaseUrl}}/api/auth/login
content-type: application/json
x-tenant-domain: {{tenantDomain}}
x-fingerprint: {{fingerprint}}

{
  "emailOrUsername": "{{loginEmail}}",
  "password": "{{loginPassword}}",
  "deviceFingerprint": "{{fingerprint}}"
}

HTTP/1.1 200  - OK
x-dns-prefetch-control: on
strict-transport-security: max-age=63072000; includeSubDomains; preload
x-frame-options: SAMEORIGIN
x-content-type-options: nosniff
x-xss-protection: 1; mode=block
referrer-policy: strict-origin-when-cross-origin
permissions-policy: camera=(), microphone=(), geolocation=(), interest-cohort=()
content-security-policy: default-src 'self'; base-uri 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: blob: https:; font-src 'self' data:; connect-src 'self' blob: https://*.cinnagen.com https://cg-gr-app.cinnagen.com:5001 https://www.gstatic.com https://cdn.jsdelivr.net; frame-ancestors 'self'; object-src 'none'; media-src 'self' https: blob:; worker-src 'self' blob:
vary: rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch
content-type: application/json
set-cookie: refresh_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjJkMzM3NGUyLWJlMTQtNDM1ZS05ZTA2LWQ2NzJhNTFlZDFkNCJ9.eyJzdWIiOiIwMUs5QUJBNk1ROUs2NE1ZN000QUVCQ0FQMiIsImF1ZCI6IjAxS0FOVEpOOVZQMzBYR0pZNEZRVENUSzdFIiwiYXpwIjoiMDFLQU5USk45VlAzMFhHSlk0RlFUQ1RLN0UiLCJzY29wZSI6IiIsInJvbGVzIjoiIiwiZXhwIjoxNzcyMjk3MTE0LCJpYXQiOjE3NzE2OTIzMTQsImp0aSI6IjhkY2Y0OTdiLWZjNGMtNDUwYy05MmI5LTgzYjZjODkxODU0YSIsImZpbmdlcnByaW50IjoiNDQxNmExOTdlM2I3ZDA4ZjgyZjc3MjEyZmQzY2M1ZmEyZTkwNzg2MWMxZDA0MGQ3ZTI4ZjUxZWIyYmM2YjlmOCIsImlkIjoiMDFLOUFCQTZNUTlLNjRNWTdNNEFFQkNBUDIiLCJ1c2VybmFtZSI6ImFiaWRpbSJ9.aJzBsOLr7hY4i6Qu5-0HMOHlYg0nX6hQVbQHR1UYctM7ifrGBDEdkmDLHign7SC0wTch3i0FXDs5jc3O2jVYANR_C6khjRgUGVNjjSBoxhCeJwdHeFmsTfeG6AFwuWs7x2bptppuyZ1gkt4TmAqsSXoW1xd5du_xnupUh6g4NaMDXCjIWeCwNhTMxL-G-O1cOxsDe9K-IHQKpZM3kjeFwSiip1mMBh45-iaUgNdhhR8dA-ziHZp7v5soQLsTYKyTsiede_JCH08a_PvFyomnVlrNF1vq4LKC_EN7d6uLhNcEFBqVUU8q7Bjpq_GCowi7vji3hV0USCYxbPvzN3K8ng; Path=/; Expires=Sat, 28 Feb 2026 16:45:16 GMT; Max-Age=604800; HttpOnly; SameSite=lax, user_session_id=01KJ0HEM2JG72M25R32MHF6PSK; Path=/; Expires=Sat, 21 Feb 2026 17:00:15 GMT; Max-Age=899; HttpOnly; SameSite=lax, sso_session=fmZbpu2-DZHpi8vSsPNmeN4IT4diZtXFLFjMbeHGICs; Domain=.cinnagen.com; Path=/; Expires=Sat, 28 Feb 2026 16:45:14 GMT; HttpOnly; Secure; SameSite=Lax, auth_user=%7B%22id%22%3A%2201K9ABA6MQ9K64MY7M4AEBCAP2%22%2C%22email%22%3A%22abidi.mahyar%40gmail.com%22%2C%22username%22%3A%22abidim%22%2C%22name%22%3A%5B%7B%22en%22%3A%22Mahyar%22%7D%2C%7B%22fa%22%3A%22%D9%85%D9%87%DB%8C%D8%A7%D8%B1%22%7D%5D%2C%22lastname%22%3A%5B%7B%22en%22%3A%22Abidi%22%7D%2C%7B%22fa%22%3A%22%D8%B9%D8%A8%DB%8C%D8%AF%DB%8C%22%7D%5D%2C%22avatar%22%3A%22https%3A%2F%2Focta.cinnagen.com%2Fauth%2Fprofiles%2Fabidi.mahyar%2540gmail.com%2Fphoto%22%2C%22profile_id%22%3A%22GhthE2toaxxnexNhHB5ncx1nHmtvaGlrehg%3D%22%2C%22isAdmin%22%3Afalse%2C%22status%22%3A%5B%7B%22id%22%3A%2201KBCZAZQ58X7BYEQXDQ4VNV07%22%2C%22icon%22%3A%22CheckCheck%22%2C%22color%22%3A%22emerald%22%2C%22label%22%3A%22Active%22%7D%5D%2C%22entityType%22%3A%5B%7B%22id%22%3A%2201KCXDKF6JJ392P4HMGC8T19TC%22%2C%22icon%22%3A%22Shield%22%2C%22color%22%3A%22rose%22%2C%22label%22%3A%22System%20Administrator%22%7D%5D%2C%22relatedCompanies%22%3A%5B%7B%22id%22%3A%2201K94V8K0RJS7D9K43F2VBTSVG%22%2C%22label%22%3A%5B%7B%22en%22%3A%22AryoGen%22%2C%22fa%22%3A%22%D8%A2%D8%B1%DB%8C%D9%88%DA%98%D9%86%22%7D%5D%7D%2C%7B%22id%22%3A%2201K94V4PJSFKCXS6AVX07P86N5%22%2C%22label%22%3A%5B%7B%22en%22%3A%22CinnaGen%22%2C%22fa%22%3A%22%D8%B3%DB%8C%D9%86%D8%A7%DA%98%D9%86%22%7D%5D%7D%5D%7D; Domain=.cinnagen.com; Path=/; Expires=Sat, 28 Feb 2026 16:45:14 GMT; HttpOnly; Secure; SameSite=Lax, cookiesession1=678A8C51B83215E9D2118F25F92DF17E;Expires=Sun, 21 Feb 2027 16:45:16 GMT;Path=/;HttpOnly, cookiesession1=678A8C500A4C24C6DE08CED159D749F6;Expires=Sun, 21 Feb 2027 16:45:16 GMT;Path=/;HttpOnly
date: Sat, 21 Feb 2026 16:45:16 GMT
connection: close
transfer-encoding: chunked
###
# Fetch lookup by ID (POST with Bearer token from login response)
# @ref login
POST {{baseUrl}}/integration/lookups/fetch/{{lookupId}}
Authorization: Bearer {{login.tokens.accessToken}}
x-tenant-domain: {{tenantDomain}}
x-fingerprint: {{fingerprint}}
content-type: application/json

{}
###
# Next.js app: Fetch lookup with sanitizeLabels=true → returns [{ id, label, icon, color }]
# @ref login
POST {{authBaseUrl}}/api/lookups/fetch/{{lookupId}}
Authorization: Bearer {{login.tokens.accessToken}}
x-tenant-domain: {{tenantDomain}}
x-fingerprint: {{fingerprint}}
content-type: application/json

{"sanitizeLabels": true}
###
# Next.js app: Get lookup options (for targetSchema=lookups, referenceEntityId=lookupId)
# @ref login
GET {{authBaseUrl}}/api/lookups/options/{{lookupId}}
Authorization: Bearer {{login.tokens.accessToken}}
x-tenant-domain: {{tenantDomain}}
x-fingerprint: {{fingerprint}}

HTTP/1.1 200  - OK
x-dns-prefetch-control: on
strict-transport-security: max-age=63072000; includeSubDomains; preload
x-frame-options: SAMEORIGIN
x-content-type-options: nosniff
x-xss-protection: 1; mode=block
referrer-policy: strict-origin-when-cross-origin
permissions-policy: camera=(), microphone=(), geolocation=(), interest-cohort=()
content-security-policy: default-src 'self'; base-uri 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: blob: https:; font-src 'self' data:; connect-src 'self' blob: https://*.cinnagen.com https://cg-gr-app.cinnagen.com:5001 https://www.gstatic.com https://cdn.jsdelivr.net; frame-ancestors 'self'; object-src 'none'; media-src 'self' https: blob:; worker-src 'self' blob:
vary: rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch
content-type: application/json
date: Sat, 21 Feb 2026 16:45:26 GMT
connection: close
transfer-encoding: chunked